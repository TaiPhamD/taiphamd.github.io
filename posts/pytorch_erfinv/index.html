<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Peter Pham">
<meta name="dcterms.date" content="2023-05-06">

<title>taiphamd - The Inverse Error Function</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">taiphamd</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../pr.html" rel="" target="">
 <span class="menu-text">Open Source</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/taiphamd" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Inverse Error Function</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">pytorch</div>
                <div class="quarto-category">metal api</div>
                <div class="quarto-category">macos</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Peter Pham </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 6, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level1">
<h1>Overview</h1>
<p>I happen to stumble upon a <a href="https://github.com/pytorch/pytorch/issues/86808">feature request</a> to implement the metal backend for the inverse error function. I thought it would be a good exercise to implement it myself.</p>
<section id="math" class="level2">
<h2 class="anchored" data-anchor-id="math">Math</h2>
<p>To work on the inverse error function, we first need an understanding of the error function. The error function is defined as:</p>
<p><span class="math display">\[
\operatorname{erf}(x)=\frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^{2}} d t
\]</span></p>
<p>The error function maps a real number in the domain <span class="math inline">\((-\infty, \infty)\)</span> to a real number from <span class="math inline">\((-1, 1)\)</span>.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.special <span class="im">import</span> erf, erfinv <span class="im">as</span> scipy_erfinv</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1000</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> erf(x)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add y as erf(x) label</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(x<span class="op">=</span>x, y<span class="op">=</span>y, labels<span class="op">=</span>{<span class="st">"x"</span>: <span class="st">"x"</span>, <span class="st">"y"</span>: <span class="st">"erf(x)"</span>})</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

<div>                            <div id="013a4943-ee44-488c-9837-f4facbcfe047" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("013a4943-ee44-488c-9837-f4facbcfe047")) {                    Plotly.newPlot(                        "013a4943-ee44-488c-9837-f4facbcfe047",                        [{"hovertemplate":"x=%{x}<br>erf(x)=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[-5.0,-4.98998998998999,-4.97997997997998,-4.96996996996997,-4.95995995995996,-4.94994994994995,-4.93993993993994,-4.92992992992993,-4.91991991991992,-4.90990990990991,-4.8998998998999,-4.88988988988989,-4.87987987987988,-4.86986986986987,-4.85985985985986,-4.84984984984985,-4.83983983983984,-4.82982982982983,-4.81981981981982,-4.80980980980981,-4.7997997997998,-4.78978978978979,-4.77977977977978,-4.76976976976977,-4.75975975975976,-4.74974974974975,-4.73973973973974,-4.72972972972973,-4.71971971971972,-4.70970970970971,-4.6996996996997,-4.68968968968969,-4.67967967967968,-4.66966966966967,-4.65965965965966,-4.64964964964965,-4.63963963963964,-4.62962962962963,-4.61961961961962,-4.60960960960961,-4.5995995995996,-4.58958958958959,-4.57957957957958,-4.56956956956957,-4.55955955955956,-4.54954954954955,-4.53953953953954,-4.52952952952953,-4.51951951951952,-4.50950950950951,-4.4994994994995,-4.48948948948949,-4.47947947947948,-4.46946946946947,-4.45945945945946,-4.44944944944945,-4.43943943943944,-4.42942942942943,-4.41941941941942,-4.40940940940941,-4.3993993993994,-4.38938938938939,-4.37937937937938,-4.36936936936937,-4.35935935935936,-4.34934934934935,-4.33933933933934,-4.32932932932933,-4.31931931931932,-4.3093093093093096,-4.2992992992992995,-4.2892892892892895,-4.2792792792792795,-4.2692692692692695,-4.2592592592592595,-4.2492492492492495,-4.2392392392392395,-4.2292292292292295,-4.2192192192192195,-4.2092092092092095,-4.1991991991991995,-4.1891891891891895,-4.1791791791791795,-4.1691691691691695,-4.1591591591591595,-4.1491491491491495,-4.1391391391391394,-4.129129129129129,-4.119119119119119,-4.109109109109109,-4.099099099099099,-4.089089089089089,-4.079079079079079,-4.069069069069069,-4.059059059059059,-4.049049049049049,-4.039039039039039,-4.029029029029029,-4.019019019019019,-4.009009009009009,-3.998998998998999,-3.988988988988989,-3.978978978978979,-3.968968968968969,-3.958958958958959,-3.948948948948949,-3.938938938938939,-3.928928928928929,-3.918918918918919,-3.908908908908909,-3.898898898898899,-3.888888888888889,-3.878878878878879,-3.868868868868869,-3.858858858858859,-3.848848848848849,-3.838838838838839,-3.828828828828829,-3.818818818818819,-3.808808808808809,-3.798798798798799,-3.7887887887887888,-3.7787787787787788,-3.7687687687687688,-3.7587587587587588,-3.7487487487487487,-3.7387387387387387,-3.7287287287287287,-3.7187187187187187,-3.7087087087087087,-3.6986986986986987,-3.6886886886886887,-3.6786786786786787,-3.6686686686686687,-3.6586586586586587,-3.6486486486486487,-3.6386386386386387,-3.6286286286286287,-3.6186186186186187,-3.6086086086086087,-3.5985985985985987,-3.5885885885885886,-3.5785785785785786,-3.5685685685685686,-3.5585585585585586,-3.5485485485485486,-3.5385385385385386,-3.5285285285285286,-3.5185185185185186,-3.5085085085085086,-3.4984984984984986,-3.4884884884884886,-3.4784784784784786,-3.4684684684684686,-3.4584584584584586,-3.4484484484484486,-3.4384384384384385,-3.4284284284284285,-3.4184184184184185,-3.4084084084084085,-3.3983983983983985,-3.388388388388388,-3.378378378378378,-3.368368368368368,-3.358358358358358,-3.348348348348348,-3.338338338338338,-3.328328328328328,-3.318318318318318,-3.308308308308308,-3.298298298298298,-3.288288288288288,-3.278278278278278,-3.268268268268268,-3.258258258258258,-3.248248248248248,-3.238238238238238,-3.228228228228228,-3.218218218218218,-3.208208208208208,-3.198198198198198,-3.188188188188188,-3.178178178178178,-3.168168168168168,-3.158158158158158,-3.148148148148148,-3.138138138138138,-3.128128128128128,-3.118118118118118,-3.108108108108108,-3.098098098098098,-3.088088088088088,-3.078078078078078,-3.068068068068068,-3.058058058058058,-3.048048048048048,-3.038038038038038,-3.028028028028028,-3.018018018018018,-3.008008008008008,-2.997997997997998,-2.987987987987988,-2.977977977977978,-2.967967967967968,-2.957957957957958,-2.947947947947948,-2.937937937937938,-2.9279279279279278,-2.9179179179179178,-2.9079079079079078,-2.8978978978978978,-2.8878878878878878,-2.8778778778778777,-2.8678678678678677,-2.8578578578578577,-2.8478478478478477,-2.8378378378378377,-2.8278278278278277,-2.8178178178178177,-2.8078078078078077,-2.7977977977977977,-2.7877877877877877,-2.7777777777777777,-2.7677677677677677,-2.7577577577577577,-2.7477477477477477,-2.7377377377377377,-2.7277277277277276,-2.7177177177177176,-2.7077077077077076,-2.6976976976976976,-2.6876876876876876,-2.6776776776776776,-2.6676676676676676,-2.6576576576576576,-2.6476476476476476,-2.6376376376376376,-2.6276276276276276,-2.6176176176176176,-2.6076076076076076,-2.5975975975975976,-2.5875875875875876,-2.5775775775775776,-2.5675675675675675,-2.5575575575575575,-2.5475475475475475,-2.5375375375375375,-2.5275275275275275,-2.5175175175175175,-2.5075075075075075,-2.4974974974974975,-2.4874874874874875,-2.4774774774774775,-2.4674674674674675,-2.4574574574574575,-2.4474474474474475,-2.4374374374374375,-2.4274274274274275,-2.4174174174174174,-2.4074074074074074,-2.3973973973973974,-2.3873873873873874,-2.3773773773773774,-2.3673673673673674,-2.3573573573573574,-2.3473473473473474,-2.3373373373373374,-2.3273273273273274,-2.3173173173173174,-2.3073073073073074,-2.2972972972972974,-2.2872872872872874,-2.2772772772772774,-2.2672672672672673,-2.2572572572572573,-2.2472472472472473,-2.2372372372372373,-2.2272272272272273,-2.2172172172172173,-2.2072072072072073,-2.1971971971971973,-2.1871871871871873,-2.1771771771771773,-2.1671671671671673,-2.1571571571571573,-2.1471471471471473,-2.1371371371371373,-2.1271271271271273,-2.1171171171171173,-2.1071071071071072,-2.0970970970970972,-2.0870870870870872,-2.0770770770770772,-2.067067067067067,-2.057057057057057,-2.047047047047047,-2.037037037037037,-2.027027027027027,-2.017017017017017,-2.007007007007007,-1.9969969969969972,-1.9869869869869872,-1.9769769769769772,-1.9669669669669672,-1.9569569569569571,-1.9469469469469471,-1.9369369369369371,-1.9269269269269271,-1.9169169169169171,-1.9069069069069071,-1.8968968968968971,-1.886886886886887,-1.876876876876877,-1.866866866866867,-1.856856856856857,-1.846846846846847,-1.836836836836837,-1.826826826826827,-1.816816816816817,-1.806806806806807,-1.796796796796797,-1.7867867867867866,-1.7767767767767766,-1.7667667667667666,-1.7567567567567566,-1.7467467467467466,-1.7367367367367366,-1.7267267267267266,-1.7167167167167166,-1.7067067067067065,-1.6966966966966965,-1.6866866866866865,-1.6766766766766765,-1.6666666666666665,-1.6566566566566565,-1.6466466466466465,-1.6366366366366365,-1.6266266266266265,-1.6166166166166165,-1.6066066066066065,-1.5965965965965965,-1.5865865865865865,-1.5765765765765765,-1.5665665665665665,-1.5565565565565564,-1.5465465465465464,-1.5365365365365364,-1.5265265265265264,-1.5165165165165164,-1.5065065065065064,-1.4964964964964964,-1.4864864864864864,-1.4764764764764764,-1.4664664664664664,-1.4564564564564564,-1.4464464464464464,-1.4364364364364364,-1.4264264264264264,-1.4164164164164164,-1.4064064064064064,-1.3963963963963963,-1.3863863863863863,-1.3763763763763763,-1.3663663663663663,-1.3563563563563563,-1.3463463463463463,-1.3363363363363363,-1.3263263263263263,-1.3163163163163163,-1.3063063063063063,-1.2962962962962963,-1.2862862862862863,-1.2762762762762763,-1.2662662662662663,-1.2562562562562563,-1.2462462462462462,-1.2362362362362362,-1.2262262262262262,-1.2162162162162162,-1.2062062062062062,-1.1961961961961962,-1.1861861861861862,-1.1761761761761762,-1.1661661661661662,-1.1561561561561562,-1.1461461461461462,-1.1361361361361362,-1.1261261261261262,-1.1161161161161162,-1.1061061061061062,-1.0960960960960962,-1.0860860860860861,-1.0760760760760761,-1.0660660660660661,-1.0560560560560561,-1.0460460460460461,-1.0360360360360361,-1.026026026026026,-1.016016016016016,-1.006006006006006,-0.9959959959959956,-0.9859859859859856,-0.9759759759759756,-0.9659659659659656,-0.9559559559559556,-0.9459459459459456,-0.9359359359359356,-0.9259259259259256,-0.9159159159159156,-0.9059059059059056,-0.8958958958958956,-0.8858858858858856,-0.8758758758758756,-0.8658658658658656,-0.8558558558558556,-0.8458458458458455,-0.8358358358358355,-0.8258258258258255,-0.8158158158158155,-0.8058058058058055,-0.7957957957957955,-0.7857857857857855,-0.7757757757757755,-0.7657657657657655,-0.7557557557557555,-0.7457457457457455,-0.7357357357357355,-0.7257257257257255,-0.7157157157157155,-0.7057057057057055,-0.6956956956956954,-0.6856856856856854,-0.6756756756756754,-0.6656656656656654,-0.6556556556556554,-0.6456456456456454,-0.6356356356356354,-0.6256256256256254,-0.6156156156156154,-0.6056056056056054,-0.5955955955955954,-0.5855855855855854,-0.5755755755755754,-0.5655655655655654,-0.5555555555555554,-0.5455455455455454,-0.5355355355355353,-0.5255255255255253,-0.5155155155155153,-0.5055055055055053,-0.4954954954954953,-0.4854854854854853,-0.4754754754754753,-0.4654654654654653,-0.4554554554554553,-0.4454454454454453,-0.4354354354354353,-0.4254254254254253,-0.41541541541541527,-0.40540540540540526,-0.39539539539539525,-0.38538538538538525,-0.37537537537537524,-0.36536536536536524,-0.35535535535535523,-0.3453453453453452,-0.3353353353353352,-0.3253253253253252,-0.3153153153153152,-0.3053053053053052,-0.2952952952952952,-0.2852852852852852,-0.2752752752752752,-0.26526526526526517,-0.25525525525525516,-0.24524524524524516,-0.23523523523523515,-0.22522522522522515,-0.21521521521521514,-0.20520520520520513,-0.19519519519519513,-0.18518518518518512,-0.1751751751751751,-0.1651651651651651,-0.1551551551551551,-0.1451451451451451,-0.1351351351351351,-0.12512512512512508,-0.11511511511511507,-0.10510510510510507,-0.09509509509509506,-0.08508508508508505,-0.07507507507507505,-0.06506506506506504,-0.055055055055055035,-0.04504504504504503,-0.03503503503503502,-0.025025025025025016,-0.01501501501501501,-0.005005005005005003,0.005005005005005003,0.01501501501501501,0.025025025025025016,0.03503503503503502,0.04504504504504503,0.055055055055055035,0.06506506506506504,0.07507507507507505,0.08508508508508505,0.09509509509509506,0.10510510510510507,0.11511511511511507,0.12512512512512508,0.1351351351351351,0.1451451451451451,0.1551551551551551,0.1651651651651651,0.1751751751751751,0.18518518518518512,0.19519519519519513,0.20520520520520513,0.21521521521521514,0.22522522522522515,0.23523523523523515,0.24524524524524516,0.25525525525525516,0.26526526526526517,0.2752752752752752,0.2852852852852852,0.2952952952952952,0.3053053053053052,0.3153153153153152,0.3253253253253252,0.3353353353353352,0.3453453453453452,0.35535535535535523,0.36536536536536524,0.37537537537537524,0.38538538538538525,0.39539539539539525,0.40540540540540526,0.41541541541541527,0.4254254254254253,0.4354354354354353,0.4454454454454453,0.4554554554554553,0.4654654654654653,0.4754754754754753,0.4854854854854853,0.4954954954954953,0.5055055055055053,0.5155155155155153,0.5255255255255253,0.5355355355355353,0.5455455455455454,0.5555555555555554,0.5655655655655654,0.5755755755755754,0.5855855855855854,0.5955955955955954,0.6056056056056054,0.6156156156156154,0.6256256256256254,0.6356356356356354,0.6456456456456454,0.6556556556556554,0.6656656656656654,0.6756756756756754,0.6856856856856854,0.6956956956956954,0.7057057057057055,0.7157157157157155,0.7257257257257255,0.7357357357357355,0.7457457457457455,0.7557557557557555,0.7657657657657655,0.7757757757757755,0.7857857857857855,0.7957957957957955,0.8058058058058055,0.8158158158158155,0.8258258258258255,0.8358358358358355,0.8458458458458455,0.8558558558558556,0.8658658658658656,0.8758758758758756,0.8858858858858856,0.8958958958958956,0.9059059059059056,0.9159159159159156,0.9259259259259256,0.9359359359359356,0.9459459459459456,0.9559559559559556,0.9659659659659656,0.9759759759759756,0.9859859859859856,0.9959959959959956,1.0060060060060056,1.0160160160160157,1.0260260260260257,1.0360360360360357,1.0460460460460457,1.0560560560560557,1.0660660660660657,1.0760760760760757,1.0860860860860857,1.0960960960960957,1.1061061061061057,1.1161161161161157,1.1261261261261257,1.1361361361361357,1.1461461461461457,1.1561561561561557,1.1661661661661658,1.1761761761761758,1.1861861861861858,1.1961961961961958,1.2062062062062058,1.2162162162162158,1.2262262262262258,1.2362362362362358,1.2462462462462458,1.2562562562562558,1.2662662662662658,1.2762762762762758,1.2862862862862858,1.2962962962962958,1.3063063063063058,1.3163163163163158,1.3263263263263259,1.3363363363363359,1.3463463463463459,1.3563563563563559,1.3663663663663659,1.3763763763763759,1.386386386386386,1.396396396396396,1.406406406406406,1.4164164164164168,1.4264264264264268,1.4364364364364368,1.4464464464464468,1.4564564564564568,1.4664664664664668,1.4764764764764768,1.4864864864864868,1.4964964964964969,1.5065065065065069,1.5165165165165169,1.5265265265265269,1.5365365365365369,1.5465465465465469,1.556556556556557,1.566566566566567,1.576576576576577,1.586586586586587,1.596596596596597,1.606606606606607,1.616616616616617,1.626626626626627,1.636636636636637,1.646646646646647,1.656656656656657,1.666666666666667,1.676676676676677,1.686686686686687,1.696696696696697,1.706706706706707,1.716716716716717,1.726726726726727,1.736736736736737,1.746746746746747,1.756756756756757,1.766766766766767,1.776776776776777,1.786786786786787,1.796796796796797,1.806806806806807,1.816816816816817,1.826826826826827,1.836836836836837,1.846846846846847,1.856856856856857,1.866866866866867,1.876876876876877,1.886886886886887,1.8968968968968971,1.9069069069069071,1.9169169169169171,1.9269269269269271,1.9369369369369371,1.9469469469469471,1.9569569569569571,1.9669669669669672,1.9769769769769772,1.9869869869869872,1.9969969969969972,2.007007007007007,2.017017017017017,2.027027027027027,2.037037037037037,2.047047047047047,2.057057057057057,2.067067067067067,2.0770770770770772,2.0870870870870872,2.0970970970970972,2.1071071071071072,2.1171171171171173,2.1271271271271273,2.1371371371371373,2.1471471471471473,2.1571571571571573,2.1671671671671673,2.1771771771771773,2.1871871871871873,2.1971971971971973,2.2072072072072073,2.2172172172172173,2.2272272272272273,2.2372372372372373,2.2472472472472473,2.2572572572572573,2.2672672672672673,2.2772772772772774,2.2872872872872874,2.2972972972972974,2.3073073073073074,2.3173173173173174,2.3273273273273274,2.3373373373373374,2.3473473473473474,2.3573573573573574,2.3673673673673674,2.3773773773773774,2.3873873873873874,2.3973973973973974,2.4074074074074074,2.4174174174174174,2.4274274274274275,2.4374374374374375,2.4474474474474475,2.4574574574574575,2.4674674674674675,2.4774774774774775,2.4874874874874875,2.4974974974974975,2.5075075075075075,2.5175175175175175,2.5275275275275275,2.5375375375375375,2.5475475475475475,2.5575575575575575,2.5675675675675675,2.5775775775775776,2.5875875875875876,2.5975975975975976,2.6076076076076076,2.6176176176176176,2.6276276276276276,2.6376376376376376,2.6476476476476476,2.6576576576576576,2.6676676676676676,2.6776776776776776,2.6876876876876876,2.6976976976976976,2.7077077077077076,2.7177177177177176,2.7277277277277276,2.7377377377377377,2.7477477477477477,2.7577577577577577,2.7677677677677677,2.7777777777777777,2.7877877877877877,2.7977977977977977,2.8078078078078077,2.8178178178178177,2.8278278278278277,2.8378378378378377,2.8478478478478477,2.8578578578578577,2.8678678678678677,2.8778778778778777,2.8878878878878878,2.8978978978978978,2.9079079079079078,2.9179179179179178,2.9279279279279278,2.937937937937938,2.947947947947948,2.957957957957958,2.967967967967968,2.977977977977978,2.987987987987988,2.997997997997998,3.0080080080080087,3.0180180180180187,3.0280280280280287,3.0380380380380387,3.0480480480480487,3.0580580580580587,3.0680680680680688,3.0780780780780788,3.0880880880880888,3.0980980980980988,3.108108108108109,3.118118118118119,3.128128128128129,3.138138138138139,3.148148148148149,3.158158158158159,3.168168168168169,3.178178178178179,3.188188188188189,3.198198198198199,3.208208208208209,3.218218218218219,3.228228228228229,3.238238238238239,3.248248248248249,3.258258258258259,3.268268268268269,3.278278278278279,3.288288288288289,3.298298298298299,3.308308308308309,3.318318318318319,3.328328328328329,3.338338338338339,3.348348348348349,3.358358358358359,3.368368368368369,3.378378378378379,3.388388388388389,3.398398398398399,3.408408408408409,3.418418418418419,3.428428428428429,3.438438438438439,3.448448448448449,3.458458458458459,3.468468468468469,3.478478478478479,3.488488488488489,3.498498498498499,3.508508508508509,3.518518518518519,3.528528528528529,3.538538538538539,3.548548548548549,3.558558558558559,3.568568568568569,3.578578578578579,3.588588588588589,3.598598598598599,3.608608608608609,3.618618618618619,3.628628628628629,3.638638638638639,3.648648648648649,3.658658658658659,3.668668668668669,3.678678678678679,3.688688688688689,3.698698698698699,3.708708708708709,3.718718718718719,3.728728728728729,3.738738738738739,3.748748748748749,3.758758758758759,3.768768768768769,3.778778778778779,3.788788788788789,3.7987987987987992,3.8088088088088092,3.8188188188188192,3.8288288288288292,3.8388388388388393,3.8488488488488493,3.8588588588588593,3.8688688688688693,3.8788788788788793,3.8888888888888893,3.8988988988988993,3.9089089089089093,3.9189189189189193,3.9289289289289293,3.9389389389389393,3.9489489489489493,3.9589589589589593,3.9689689689689693,3.9789789789789793,3.9889889889889893,3.9989989989989994,4.009009009009009,4.019019019019019,4.029029029029029,4.039039039039039,4.049049049049049,4.059059059059059,4.069069069069069,4.079079079079079,4.089089089089089,4.099099099099099,4.109109109109109,4.119119119119119,4.129129129129129,4.1391391391391394,4.1491491491491495,4.1591591591591595,4.1691691691691695,4.1791791791791795,4.1891891891891895,4.1991991991991995,4.2092092092092095,4.2192192192192195,4.2292292292292295,4.2392392392392395,4.2492492492492495,4.2592592592592595,4.2692692692692695,4.2792792792792795,4.2892892892892895,4.2992992992992995,4.3093093093093096,4.31931931931932,4.32932932932933,4.33933933933934,4.34934934934935,4.35935935935936,4.36936936936937,4.37937937937938,4.38938938938939,4.3993993993994,4.40940940940941,4.41941941941942,4.42942942942943,4.43943943943944,4.44944944944945,4.45945945945946,4.46946946946947,4.47947947947948,4.48948948948949,4.4994994994995,4.50950950950951,4.51951951951952,4.52952952952953,4.53953953953954,4.54954954954955,4.55955955955956,4.56956956956957,4.57957957957958,4.58958958958959,4.5995995995996,4.60960960960961,4.61961961961962,4.62962962962963,4.63963963963964,4.64964964964965,4.65965965965966,4.66966966966967,4.67967967967968,4.68968968968969,4.6996996996997,4.70970970970971,4.71971971971972,4.72972972972973,4.73973973973974,4.74974974974975,4.75975975975976,4.76976976976977,4.77977977977978,4.78978978978979,4.7997997997998,4.80980980980981,4.81981981981982,4.82982982982983,4.83983983983984,4.84984984984985,4.85985985985986,4.86986986986987,4.87987987987988,4.88988988988989,4.8998998998999,4.90990990990991,4.91991991991992,4.92992992992993,4.93993993993994,4.94994994994995,4.95995995995996,4.96996996996997,4.97997997997998,4.98998998998999,5.0],"xaxis":"x","y":[-0.9999999999984626,-0.9999999999982976,-0.9999999999981153,-0.9999999999979138,-0.9999999999976913,-0.9999999999974456,-0.9999999999971743,-0.9999999999968747,-0.9999999999965442,-0.9999999999961794,-0.9999999999957768,-0.9999999999953328,-0.9999999999948432,-0.9999999999943033,-0.9999999999937081,-0.9999999999930521,-0.9999999999923292,-0.9999999999915328,-0.9999999999906556,-0.9999999999896894,-0.9999999999886255,-0.9999999999874545,-0.9999999999861655,-0.9999999999847471,-0.9999999999831866,-0.99999999998147,-0.9999999999795822,-0.9999999999775065,-0.9999999999752247,-0.9999999999727168,-0.9999999999699609,-0.9999999999669331,-0.9999999999636072,-0.9999999999599548,-0.9999999999559444,-0.9999999999515419,-0.9999999999467098,-0.9999999999414075,-0.9999999999355903,-0.9999999999292093,-0.9999999999222116,-0.9999999999145388,-0.9999999999061276,-0.9999999998969088,-0.9999999998868069,-0.9999999998757395,-0.9999999998636168,-0.9999999998503406,-0.9999999998358045,-0.9999999998198916,-0.9999999998024753,-0.9999999997834175,-0.9999999997625674,-0.999999999739761,-0.9999999997148199,-0.9999999996875498,-0.9999999996577391,-0.9999999996251575,-0.9999999995895549,-0.9999999995506587,-0.9999999995081729,-0.9999999994617753,-0.9999999994111162,-0.9999999993558151,-0.9999999992954587,-0.999999999229598,-0.9999999991577457,-0.9999999990793723,-0.9999999989939031,-0.9999999989007142,-0.9999999987991289,-0.9999999986884127,-0.9999999985677692,-0.9999999984363346,-0.9999999982931722,-0.999999998137267,-0.9999999979675187,-0.9999999977827351,-0.9999999975816249,-0.9999999973627894,-0.999999997124714,-0.999999996865759,-0.9999999965841498,-0.9999999962779658,-0.9999999959451292,-0.9999999955833925,-0.9999999951903249,-0.9999999947632986,-0.9999999942994725,-0.9999999937957765,-0.9999999932488928,-0.9999999926552375,-0.9999999920109398,-0.9999999913118194,-0.9999999905533636,-0.9999999897307016,-0.9999999888385767,-0.9999999878713175,-0.9999999868228064,-0.999999985686446,-0.9999999844551224,-0.9999999831211671,-0.9999999816763154,-0.9999999801116616,-0.9999999784176116,-0.9999999765838319,-0.999999974599195,-0.999999972451721,-0.9999999701285148,-0.9999999676156996,-0.999999964898345,-0.9999999619603905,-0.999999958784564,-0.999999955352294,-0.9999999516436163,-0.9999999476370743,-0.9999999433096121,-0.9999999386364609,-0.9999999335910174,-0.9999999281447138,-0.9999999222668801,-0.9999999159245956,-0.9999999090825319,-0.9999999017027849,-0.9999998937446956,-0.9999998851646597,-0.9999998759159239,-0.9999998659483696,-0.9999998552082823,-0.9999998436381058,-0.9999998311761809,-0.9999998177564676,-0.9999998033082486,-0.9999997877558147,-0.99999977101813,-0.9999997530084761,-0.9999997336340736,-0.9999997127956798,-0.9999996903871621,-0.9999996662950436,-0.999999640398022,-0.999999612566458,-0.9999995826618318,-0.9999995505361678,-0.9999995160314236,-0.999999478978841,-0.9999994391982598,-0.9999993964973892,-0.9999993506710351,-0.9999993015002829,-0.999999248751631,-0.999999192176073,-0.9999991315081262,-0.9999990664648039,-0.9999989967445269,-0.9999989220259726,-0.9999988419668576,-0.9999987562026503,-0.9999986643452098,-0.999998565981348,-0.9999984606713099,-0.9999983479471681,-0.9999982273111278,-0.9999980982337368,-0.9999979601519964,-0.9999978124673682,-0.9999976545436703,-0.9999974857048598,-0.9999973052326935,-0.9999971123642623,-0.9999969062893931,-0.9999966861479109,-0.9999964510267549,-0.999996199956942,-0.9999959319103696,-0.9999956457964507,-0.9999953404585733,-0.9999950146703755,-0.9999946671318288,-0.9999942964651193,-0.9999939012103186,-0.9999934798208352,-0.999993030658635,-0.9999925519892219,-0.9999920419763678,-0.9999914986765799,-0.9999909200332948,-0.9999903038707878,-0.9999896478877832,-0.999988949650756,-0.9999882065869085,-0.9999874159768104,-0.9999865749466883,-0.9999856804603481,-0.9999847293107175,-0.9999837181109922,-0.9999826432853699,-0.9999815010593548,-0.9999802874496172,-0.9999789982533893,-0.9999776290373803,-0.9999761751261902,-0.9999746315902062,-0.9999729932329593,-0.9999712545779225,-0.9999694098547288,-0.9999674529847894,-0.999965377566287,-0.9999631768585262,-0.9999608437656133,-0.9999583708194462,-0.9999557501619861,-0.9999529735267912,-0.9999500322197814,-0.9999469170992136,-0.9999436185548369,-0.9999401264862043,-0.9999364302801103,-0.9999325187871282,-0.9999283802972191,-0.999924002514381,-0.9999193725303112,-0.9999144767970499,-0.9999093010985761,-0.9999038305213227,-0.9998980494235818,-0.9998919414037666,-0.999885489267497,-0.9998786749934793,-0.9998714796981433,-0.9998638835990055,-0.9998558659767246,-0.9998474051358149,-0.9998384783639834,-0.9998290618900566,-0.9998191308404625,-0.9998086591942328,-0.9997976197364911,-0.9997859840103916,-0.9997737222674747,-0.9997608034164035,-0.9997471949700483,-0.9997328629908827,-0.9997177720346605,-0.9997018850923352,-0.9996851635301921,-0.9996675670281602,-0.9996490535162675,-0.9996295791092137,-0.9996090980390229,-0.9995875625857515,-0.9995649230062175,-0.9995411274607238,-0.9995161219377491,-0.9994898501765771,-0.9994622535878414,-0.9994332711719583,-0.9994028394354293,-0.9993708923049865,-0.9993373610395669,-0.9993021741400914,-0.999265257257038,-0.9992265330957903,-0.999185921319752,-0.9991433384512145,-0.9990986977699723,-0.9990519092096782,-0.999002879251938,-0.9989515108181402,-0.9988977031590278,-0.9988413517420142,-0.998782348136251,-0.998720579895463,-0.9986559304385606,-0.9985882789280499,-0.9985175001462623,-0.9984434643694288,-0.998366037239627,-0.998285079634636,-0.9982004475357341,-0.9981119918934838,-0.9980195584915461,-0.9979229878085788,-0.9978221148782694,-0.9977167691475664,-0.9976067743331704,-0.9974919482763568,-0.997372102796204,-0.9972470435413069,-0.997116569840062,-0.9969804745496145,-0.9968385439035635,-0.9966905573585286,-0.9965362874396853,-0.9963754995853821,-0.9962079519909622,-0.9960333954519124,-0.9958515732064724,-0.9956622207778454,-0.9954650658161498,-0.9952598279402677,-0.9950462185797442,-0.9948239408169031,-0.9945926892293487,-0.9943521497330297,-0.9941019994260492,-0.9938419064334109,-0.9935715297528956,-0.9932905191022732,-0.9929985147680562,-0.9926951474560135,-0.9923800381436623,-0.9920527979349695,-0.9917130279174944,-0.9913603190222139,-0.9909942518862749,-0.9906143967189284,-0.9902203131708998,-0.9898115502074609,-0.9893876459854715,-0.9889481277346628,-0.9884925116434442,-0.9880203027495145,-0.9875309948355666,-0.9870240703303786,-0.9864990002155863,-0.9859552439384385,-0.9853922493308387,-0.9848094525349799,-0.9842062779358812,-0.9835821381011413,-0.9829364337282194,-0.9822685535995636,-0.981577874545901,-0.9808637614180109,-0.9801255670672984,-0.9793626323354879,-0.978574286053757,-0.9777598450516265,-0.9769186141759258,-0.9760498863201473,-0.9751529424645033,-0.9742270517269959,-0.9732714714258051,-0.9722854471533007,-0.9712682128619742,-0.9702189909625849,-0.9691369924348089,-0.9680214169506712,-0.966871453011039,-0.9656862780954392,-0.9644650588254648,-0.9632069511420186,-0.9619111004966355,-0.9605766420571188,-0.9592027009277085,-0.9577883923839949,-0.956332822122775,-0.9548350865270392,-0.9532942729462601,-0.9517094599921468,-0.9500797178500064,-0.9484041086058467,-0.9466816865893339,-0.9449114987327062,-0.9430925849457237,-0.9412239785067233,-0.9393047064698237,-0.9373337900883102,-0.9353102452542124,-0.9332330829540616,-0.9311013097408025,-0.9289139282218081,-0.926669937562927,-0.9243683340084744,-0.9220081114170481,-0.9195882618130395,-0.9171077759536774,-0.9145656439114246,-0.911960855671523,-0.9092924017444587,-0.9065592737930963,-0.9037604652742045,-0.9008949720940742,-0.8979617932779045,-0.8949599316526069,-0.8918883945426543,-0.8887461944785757,-0.8855323499176737,-0.8822458859765179,-0.8788858351747391,-0.8754512381896308,-0.8719411446210334,-0.8683546137659572,-0.8646907154023742,-0.8609485305815858,-0.8571271524285504,-0.8532256869495289,-0.8492432538463901,-0.8451789873368877,-0.8410320369802069,-0.8368015685070517,-0.832486764653524,-0.8280868259980331,-0.823600971800443,-0.8190284408426572,-0.8143684922698179,-0.8096204064312782,-0.8047834857204978,-0.799857055412986,-0.794840464501413,-0.7897330865269884,-0.7845343204062022,-0.7792435912520038,-0.7738603511884913,-0.7683840801581715,-0.7628142867208454,-0.7571505088431634,-0.751392314677896,-0.7455393033319554,-0.7395911056222031,-0.7335473848180823,-0.7274078373701023,-0.7211721936232168,-0.7148402185141318,-0.7084117122515864,-0.7018865109786545,-0.6952644874161243,-0.6885455514860185,-0.6817296509143289,-0.6748167718120529,-0.6678069392336266,-0.6607002177118723,-0.6534967117685837,-0.6461965663998985,-0.6387999675356208,-0.6313071424716782,-0.623718360274921,-0.6160339321594916,-0.6082542118340181,-0.6003795958189104,-0.5924105237330684,-0.5843474785493319,-0.5761909868180424,-0.5679416188581069,-0.5595999889149967,-0.5511667552851369,-0.5426426204061857,-0.5340283309127336,-0.5253246776569885,-0.5165324956940552,-0.5076526642314513,-0.4986861065425407,-0.4896337898436153,-0.48049672513438185,-0.4712759670016673,-0.4619726133861877,-0.45258780531227705,-0.44312272658050866,-0.4335786034231946,-0.4239567041227824,-0.414258338593226,-0.40448485792444117,-0.39463765389000965,-0.3847181584183376,-0.3747278430275216,-0.3646682182242189,-0.3545408328668678,-0.34434727349364536,-0.3340891636155988,-0.3237681629754285,-0.31338596677244707,-0.30294430485428353,-0.2924449408759425,-0.28188967142687493,-0.27128032512675554,-0.26061876169070697,-0.24990687096474962,-0.23914657193229533,-0.22833981169254453,-0.21748856441168185,-0.20659483024780348,-0.19566063425054445,-0.1846880252364092,-0.1736790746408411,-0.16263587534809967,-0.1515605405000433,-0.14045520228494526,-0.12932201070749832,-0.11816313234118858,-0.10698074906424468,-0.09577705678039006,-0.08455426412564805,-0.07331459116246868,-0.06206026806246342,-0.05079353377905073,-0.03951663471132844,-0.02823182336050217,-0.016941356980208697,-0.00564749622208221,0.00564749622208221,0.016941356980208697,0.02823182336050217,0.03951663471132844,0.05079353377905073,0.06206026806246342,0.07331459116246868,0.08455426412564805,0.09577705678039006,0.10698074906424468,0.11816313234118858,0.12932201070749832,0.14045520228494526,0.1515605405000433,0.16263587534809967,0.1736790746408411,0.1846880252364092,0.19566063425054445,0.20659483024780348,0.21748856441168185,0.22833981169254453,0.23914657193229533,0.24990687096474962,0.26061876169070697,0.27128032512675554,0.28188967142687493,0.2924449408759425,0.30294430485428353,0.31338596677244707,0.3237681629754285,0.3340891636155988,0.34434727349364536,0.3545408328668678,0.3646682182242189,0.3747278430275216,0.3847181584183376,0.39463765389000965,0.40448485792444117,0.414258338593226,0.4239567041227824,0.4335786034231946,0.44312272658050866,0.45258780531227705,0.4619726133861877,0.4712759670016673,0.48049672513438185,0.4896337898436153,0.4986861065425407,0.5076526642314513,0.5165324956940552,0.5253246776569885,0.5340283309127336,0.5426426204061857,0.5511667552851369,0.5595999889149967,0.5679416188581069,0.5761909868180424,0.5843474785493319,0.5924105237330684,0.6003795958189104,0.6082542118340181,0.6160339321594916,0.623718360274921,0.6313071424716782,0.6387999675356208,0.6461965663998985,0.6534967117685837,0.6607002177118723,0.6678069392336266,0.6748167718120529,0.6817296509143289,0.6885455514860185,0.6952644874161243,0.7018865109786545,0.7084117122515864,0.7148402185141318,0.7211721936232168,0.7274078373701023,0.7335473848180823,0.7395911056222031,0.7455393033319554,0.751392314677896,0.7571505088431634,0.7628142867208454,0.7683840801581715,0.7738603511884913,0.7792435912520038,0.7845343204062022,0.7897330865269884,0.794840464501413,0.799857055412986,0.8047834857204978,0.8096204064312782,0.8143684922698179,0.8190284408426572,0.823600971800443,0.8280868259980331,0.832486764653524,0.8368015685070517,0.8410320369802069,0.8451789873368876,0.8492432538463899,0.8532256869495287,0.8571271524285502,0.8609485305815857,0.864690715402374,0.868354613765957,0.8719411446210333,0.8754512381896307,0.878885835174739,0.8822458859765178,0.8855323499176737,0.8887461944785756,0.8918883945426542,0.8949599316526067,0.8979617932779043,0.900894972094074,0.9037604652742044,0.9065592737930962,0.9092924017444586,0.9119608556715227,0.9145656439114245,0.9171077759536773,0.9195882618130394,0.922008111417048,0.9243683340084743,0.926669937562927,0.928913928221808,0.9311013097408025,0.9332330829540615,0.9353102452542122,0.9373337900883101,0.9393047064698236,0.9412239785067232,0.9430925849457236,0.9449114987327061,0.9466816865893338,0.9484041086058466,0.9500797178500063,0.9517094599921467,0.95329427294626,0.9548350865270392,0.9563328221227752,0.9577883923839949,0.9592027009277085,0.9605766420571189,0.9619111004966356,0.9632069511420187,0.964465058825465,0.9656862780954392,0.966871453011039,0.9680214169506713,0.9691369924348089,0.970218990962585,0.9712682128619743,0.9722854471533007,0.9732714714258051,0.974227051726996,0.9751529424645035,0.9760498863201473,0.9769186141759258,0.9777598450516265,0.9785742860537571,0.9793626323354879,0.9801255670672984,0.9808637614180109,0.981577874545901,0.9822685535995636,0.9829364337282194,0.9835821381011413,0.9842062779358812,0.9848094525349799,0.9853922493308388,0.9859552439384385,0.9864990002155863,0.9870240703303786,0.9875309948355666,0.9880203027495145,0.9884925116434442,0.9889481277346628,0.9893876459854715,0.9898115502074609,0.9902203131708998,0.9906143967189284,0.9909942518862749,0.9913603190222139,0.9917130279174944,0.9920527979349695,0.9923800381436623,0.9926951474560135,0.9929985147680562,0.9932905191022732,0.9935715297528956,0.9938419064334109,0.9941019994260492,0.9943521497330297,0.9945926892293487,0.9948239408169031,0.9950462185797442,0.9952598279402677,0.9954650658161498,0.9956622207778454,0.9958515732064724,0.9960333954519124,0.9962079519909622,0.9963754995853821,0.9965362874396853,0.9966905573585286,0.9968385439035635,0.9969804745496145,0.997116569840062,0.9972470435413069,0.997372102796204,0.9974919482763568,0.9976067743331704,0.9977167691475664,0.9978221148782694,0.9979229878085788,0.9980195584915461,0.9981119918934838,0.9982004475357341,0.998285079634636,0.998366037239627,0.9984434643694288,0.9985175001462623,0.9985882789280499,0.9986559304385606,0.998720579895463,0.998782348136251,0.9988413517420142,0.9988977031590278,0.9989515108181402,0.999002879251938,0.9990519092096782,0.9990986977699723,0.9991433384512145,0.999185921319752,0.9992265330957903,0.999265257257038,0.9993021741400914,0.9993373610395669,0.9993708923049865,0.9994028394354293,0.9994332711719583,0.9994622535878414,0.9994898501765771,0.9995161219377491,0.9995411274607238,0.9995649230062175,0.9995875625857515,0.9996090980390229,0.9996295791092137,0.9996490535162675,0.9996675670281602,0.9996851635301921,0.9997018850923352,0.9997177720346605,0.9997328629908827,0.9997471949700483,0.9997608034164035,0.9997737222674747,0.9997859840103916,0.9997976197364911,0.9998086591942328,0.9998191308404625,0.9998290618900566,0.9998384783639834,0.9998474051358149,0.9998558659767246,0.9998638835990055,0.9998714796981433,0.9998786749934793,0.999885489267497,0.9998919414037666,0.9998980494235818,0.9999038305213227,0.9999093010985761,0.9999144767970499,0.9999193725303112,0.999924002514381,0.9999283802972191,0.9999325187871282,0.9999364302801103,0.9999401264862043,0.9999436185548369,0.9999469170992136,0.9999500322197814,0.9999529735267912,0.9999557501619861,0.9999583708194462,0.9999608437656133,0.9999631768585262,0.999965377566287,0.9999674529847894,0.9999694098547288,0.9999712545779225,0.9999729932329593,0.9999746315902062,0.9999761751261902,0.9999776290373803,0.9999789982533893,0.9999802874496172,0.9999815010593548,0.9999826432853699,0.9999837181109922,0.9999847293107175,0.9999856804603481,0.9999865749466883,0.9999874159768104,0.9999882065869085,0.999988949650756,0.9999896478877832,0.9999903038707878,0.9999909200332948,0.9999914986765799,0.9999920419763678,0.9999925519892219,0.999993030658635,0.9999934798208352,0.9999939012103186,0.9999942964651193,0.9999946671318288,0.9999950146703755,0.9999953404585733,0.9999956457964507,0.9999959319103696,0.999996199956942,0.9999964510267549,0.9999966861479109,0.9999969062893931,0.9999971123642623,0.9999973052326935,0.9999974857048598,0.9999976545436703,0.9999978124673682,0.9999979601519964,0.9999980982337368,0.9999982273111278,0.9999983479471681,0.9999984606713099,0.999998565981348,0.9999986643452098,0.9999987562026503,0.9999988419668576,0.9999989220259726,0.9999989967445269,0.9999990664648039,0.9999991315081262,0.999999192176073,0.999999248751631,0.9999993015002829,0.9999993506710351,0.9999993964973892,0.9999994391982598,0.999999478978841,0.9999995160314236,0.9999995505361678,0.9999995826618318,0.999999612566458,0.999999640398022,0.9999996662950436,0.9999996903871621,0.9999997127956798,0.9999997336340736,0.9999997530084761,0.99999977101813,0.9999997877558147,0.9999998033082486,0.9999998177564676,0.9999998311761809,0.9999998436381058,0.9999998552082823,0.9999998659483696,0.9999998759159239,0.9999998851646597,0.9999998937446956,0.9999999017027849,0.9999999090825319,0.9999999159245956,0.9999999222668801,0.9999999281447138,0.9999999335910174,0.9999999386364609,0.9999999433096121,0.9999999476370743,0.9999999516436163,0.999999955352294,0.999999958784564,0.9999999619603905,0.999999964898345,0.9999999676156996,0.9999999701285148,0.999999972451721,0.999999974599195,0.9999999765838319,0.9999999784176116,0.9999999801116616,0.9999999816763154,0.9999999831211671,0.9999999844551224,0.999999985686446,0.9999999868228064,0.9999999878713175,0.9999999888385767,0.9999999897307016,0.9999999905533636,0.9999999913118194,0.9999999920109398,0.9999999926552375,0.9999999932488928,0.9999999937957765,0.9999999942994725,0.9999999947632986,0.9999999951903249,0.9999999955833925,0.9999999959451292,0.9999999962779658,0.9999999965841498,0.999999996865759,0.999999997124714,0.9999999973627894,0.9999999975816249,0.9999999977827351,0.9999999979675187,0.999999998137267,0.9999999982931722,0.9999999984363346,0.9999999985677692,0.9999999986884127,0.9999999987991289,0.9999999989007142,0.9999999989939031,0.9999999990793723,0.9999999991577457,0.999999999229598,0.9999999992954587,0.9999999993558151,0.9999999994111162,0.9999999994617753,0.9999999995081729,0.9999999995506587,0.9999999995895549,0.9999999996251575,0.9999999996577391,0.9999999996875498,0.9999999997148199,0.999999999739761,0.9999999997625674,0.9999999997834175,0.9999999998024753,0.9999999998198916,0.9999999998358045,0.9999999998503406,0.9999999998636168,0.9999999998757395,0.9999999998868069,0.9999999998969088,0.9999999999061276,0.9999999999145388,0.9999999999222116,0.9999999999292093,0.9999999999355903,0.9999999999414075,0.9999999999467098,0.9999999999515419,0.9999999999559444,0.9999999999599548,0.9999999999636072,0.9999999999669331,0.9999999999699609,0.9999999999727168,0.9999999999752247,0.9999999999775065,0.9999999999795822,0.99999999998147,0.9999999999831866,0.9999999999847471,0.9999999999861655,0.9999999999874545,0.9999999999886255,0.9999999999896894,0.9999999999906556,0.9999999999915328,0.9999999999923292,0.9999999999930521,0.9999999999937081,0.9999999999943033,0.9999999999948432,0.9999999999953328,0.9999999999957768,0.9999999999961794,0.9999999999965442,0.9999999999968747,0.9999999999971743,0.9999999999974456,0.9999999999976913,0.9999999999979138,0.9999999999981153,0.9999999999982976,0.9999999999984626],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"x"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"erf(x)"}},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('013a4943-ee44-488c-9837-f4facbcfe047');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>The inverse error function is defined as: <span class="math display">\[
\operatorname{erf}^{-1}(\operatorname{erf}(x))=x
\]</span></p>
<p>This means the inverse error function will have a domain of <span class="math inline">\((-1, 1)\)</span> and a range of <span class="math inline">\((-\infty, \infty)\)</span>.</p>
<p>There is no closed-form solution for the inverse error function however it can be approximated using elementary function as proposed by Abramowitz and Stegun<span class="citation" data-cites="educare_error_in_functions">[<a href="#ref-educare_error_in_functions" role="doc-biblioref">1</a>]</span>. The approximation is given by:</p>
<p><span class="math display">\[
\operatorname{erf}^{-1}(x) \approx \operatorname{sgn}(x) \sqrt{\sqrt{\left(\frac{2}{\pi a}+\frac{\ln(1-x^{2})}{2}\right)^{2}-  \frac{\ln (1-x^{2})}{a}   }- (\frac{2}{\pi a}+\frac{\ln (1-x^{2})}{2})}
\]</span></p>
<p>where <span class="math inline">\(a=0.147\)</span> or <span class="math inline">\(a=0.140012\)</span> where the latter is more accurate around <span class="math inline">\(x=0\)</span> for the error function but the former has a smaller maximum error for the error function. There was no analysis given for the maximum error rate of the inverse error function so I will have to experiment with it myself.</p>
<p>I am going to re-draw that same graph but using the approximation method.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> erfinv(x):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute the inverse error function using an approximation method</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the Abravov fast approximation method</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="fl">0.147</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute the first term</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    term <span class="op">=</span> np.sqrt(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        np.sqrt(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">2</span> <span class="op">/</span> (np.pi <span class="op">*</span> a) <span class="op">+</span> np.log(<span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="dv">2</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> np.log(<span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> a</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span> (<span class="dv">2</span> <span class="op">/</span> (np.pi <span class="op">*</span> a) <span class="op">+</span> np.log(<span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute the sign</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sign <span class="op">*</span> term</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectorize the erfinv function</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>erfinv_vec <span class="op">=</span> np.vectorize(erfinv)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>y_rapid <span class="op">=</span> erfinv_vec(x)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Add y as erfinv(x) label</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(x<span class="op">=</span>x, y<span class="op">=</span>y_rapid, labels<span class="op">=</span>{<span class="st">"x"</span>: <span class="st">"x"</span>, <span class="st">"y"</span>: <span class="st">"erfinv(x)"</span>})</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lets compute the MSE between approximation and the scipy implementation using <span class="math inline">\(a = 0.147\)</span></p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> erfinv(x, a<span class="op">=</span><span class="fl">0.147</span>):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Compute the inverse error function using an approximation method</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the Abravov fast approximation method</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute the first term</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    term <span class="op">=</span> np.sqrt(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        np.sqrt(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">2</span> <span class="op">/</span> (np.pi <span class="op">*</span> a) <span class="op">+</span> np.log(<span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="dv">2</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> np.log(<span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> a</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span> (<span class="dv">2</span> <span class="op">/</span> (np.pi <span class="op">*</span> a) <span class="op">+</span> np.log(<span class="dv">1</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute the sign</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sign <span class="op">*</span> term</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectorize the erf_rapid function</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>erfinv_vec <span class="op">=</span> np.vectorize(erfinv)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>y_rapid <span class="op">=</span> erfinv_vec(x)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>y_scipy <span class="op">=</span> scipy_erfinv(x)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mask where y_rapid isn't infinite</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.isfinite(y_rapid)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>y_rapid <span class="op">=</span> y_rapid[mask]</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>y_scipy <span class="op">=</span> y_scipy[mask]</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> np.mean((y_rapid <span class="op">-</span> y_scipy) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"MSE: </span><span class="sc">{</span>mse<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"MSE: </span><span class="sc">{</span>mse<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Max Error: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">max</span>(np.<span class="bu">abs</span>(y_rapid <span class="op">-</span> y_scipy))<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MSE: 1.7424258166713035e-07
Max Error: 0.003953770269546908</code></pre>
</div>
</div>
<p>Now re-peat the experiment but using <span class="math inline">\(a=0.140012\)</span></p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>y_rapid2 <span class="op">=</span> erfinv_vec(x, a<span class="op">=</span><span class="fl">0.140012</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y_scipy <span class="op">=</span> scipy_erfinv(x)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mask where y_rapid isn't infinite</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.isfinite(y_rapid2)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>y_rapid2 <span class="op">=</span> y_rapid2[mask]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>y_scipy <span class="op">=</span> y_scipy[mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> np.mean((y_rapid2 <span class="op">-</span> y_scipy) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"MSE: </span><span class="sc">{</span>mse<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Max Error: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">max</span>(np.<span class="bu">abs</span>(y_rapid2 <span class="op">-</span> y_scipy))<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MSE: 8.462108415211391e-07
Max Error: 0.007140781441225208</code></pre>
</div>
</div>
</section>
<section id="pytorch-implementation" class="level2">
<h2 class="anchored" data-anchor-id="pytorch-implementation">Pytorch Implementation</h2>
<p>Now that we have a decent approximation of the inverse error function, we can implement it in pytorch. I will be using the <span class="math inline">\(a=0.147\)</span> approximation method since it gives a less maximum error.</p>
<p>[TO DO: Add pytorch implementation]</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-educare_error_in_functions" class="csl-entry" role="listitem">
1. <span class="smallcaps">EduCare</span>. 2023. Error in functions. <a href="https://www.educare.bz/unit/error-in-functions/">https://www.educare.bz/unit/error-in-functions/</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>